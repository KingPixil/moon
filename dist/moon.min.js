/**
 * Moon v0.11.0
 * Copyright 2016-2018 Kabir Shah
 * Released under the MIT License
 * http://moonjs.ga
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";var e={},t={},n={},r=function(e){!1===Q.config.silent&&console.log(e)},o=function(e){!1===Q.config.silent&&console.error("[Moon] ERROR: "+e)},i=function(e,t){var n=e.hooks[t];void 0!==n&&n.call(e)},a=function(e,t,n,r){e[t]=void 0===n?r:n},s=function(){},v=function(e,t){var n=function(n){var r=function(e){for(var t=r.handlers,n=0;n<t.length;n++)t[n](e)};r.handlers=t[n],t[n]=r,e.addEventListener(n,r)};for(var r in t)n(r)},d=function(e){var t,n=e.type,r=e.data;if("#text"===n)t=document.createTextNode(e.value);else{var o=e.children;t=(r.flags&I)===I?document.createElementNS("http://www.w3.org/2000/svg",n):document.createElement(n);for(var i=0;i<o.length;i++)l(o[i],t);var a=r.events;void 0!==a&&v(t,a),g(t,void 0,e,e.props)}return r.node=t,t},u=function(e,t,n){var r=n.options.props,o=t.props.attrs,i={};if(void 0!==r&&void 0!==o)for(var a=0;a<r.length;a++){var s=r[a];i[s]=o[s]}var v={root:e,props:i,insert:t.children},d=t.data.events;v.events=void 0===d?{}:d;var u=new n.CTor(v),f=t.data;f.component=u,f.node=u.root},f=function(e,t){t.appendChild(e)},l=function(e,t){var n=e.data.component;if(void 0===n)f(d(e),t);else{var r=document.createElement(e.type);f(r,t),u(r,e,n)}},c=function(e,t){t.removeChild(e)},p=function(e,t,n){n.replaceChild(e,t)},h=function(e,t,n){var r=t.data,o=r.component;void 0!==o&&o.destroy();var i=e.data.component;void 0===i?p(d(e),r.node,n):u(r.node,e,i)},m=function(e,t,r,o){if("#text"===e)return{type:e,data:t,value:r};var i=n[e];return void 0!==i&&(r.component=i),{type:e,props:t,data:r,children:o}};m.flatten=function(e){for(var t=0;t<e.length;){var n=e[t];if(!0===Array.isArray(n)){var r=n.length;n.unshift(t,1),e.splice.apply(e,n),n.slice(2,0),t+=r}else t++}return e},m.renderClass=function(e){if("string"==typeof e)return e;var t="",n="";if(!0===Array.isArray(e))for(var r=0;r<e.length;r++)t+=n+m.renderClass(e[r]),n=" ";else if("object"==typeof e)for(var o in e)!0===e[o]&&(t+=n+o,n=" ");return t},m.renderLoop=function(e,t){var n;if(Array.isArray(e)){var r=e.length;n=new Array(r);for(var o=0;o<r;o++)n[o]=t(e[o],o)}else if("object"==typeof e)for(var i in n=[],e)n.push(t(e[i],i));else if("number"==typeof e){n=new Array(e);for(var a=0;a<e;a++)n[a]=t(a+1,a)}return n};var g=function(t,n,r,o){var i=o.attrs;if(void 0===i){if(void 0!==n)for(var a in n)t.removeAttribute(a)}else if(void 0===n)for(var s in i){var v=i[s];t.setAttribute(s,!0===v?"":v)}else{for(var d in i){var u=i[d],f=n[d];!1===u||void 0!==f&&u===f||t.setAttribute(d,!0===u?"":u)}for(var l in n){var c=i[l];void 0!==c&&!1!==c||t.removeAttribute(l)}}var p=o.directives;if(void 0!==p)for(var h in p){var m=e[h];void 0!==m&&m(t,p[h],r)}var g=o.dom;if(void 0!==g)for(var y in g)t[y]=g[y]},y=function(e,t){for(var n in e)t[n].handlers=e[n]},b=function(e,t){var n=t.data;n.node=e;for(var r=t.props,o=e.attributes,i={},a=0;a<o.length;a++){var s=o[a];i[s.name]=s.value}g(e,i,t,r);var f=n.events;void 0!==f&&v(e,f);var h=r.dom;if(void 0===h||void 0===h.innerHTML&&void 0===h.textContent)for(var m=t.children,y=m.length,x=0,A=x===y?void 0:m[x],O=e.firstChild;void 0!==A||null!==O;){if(null===O)l(A,e);else{var w=O.nextSibling;if(void 0===A)c(O,e);else{var N=A.data.component;if(void 0!==N)u(O,A,N);else{var C=A.type;O.nodeName.toLowerCase()!==C?p(d(A),O,e):"#text"===C?(O.textContent=A.value,A.data.node=O):b(O,A)}}O=w}A=++x<y?m[x]:void 0}},x=function(e,t){var n=t.data,r=n.node,o=e.props;g(r,t.props.attrs,e,o),t.props=o;var a=e.data.events;void 0!==a&&y(a,n.events),function(e,t,n){for(var r,o,a,s,v=e.length,d=t.length,u=v>d?v:d,f=0;f<u;f++)if(f>=v)r=t.pop(),o=n,s=void 0,a=r.data,void 0!==(s=a.component)&&s.destroy(),c(a.node,o);else if(f>=d)l(t[f]=e[f],n);else{var p=e[f],m=t[f];if(p!==m){var g=p.type;if(g!==m.type)h(p,m,n),t[f]=p;else{var b=m.data,A=b.component;if(void 0!==A){var O=!1,w=A.options.props;if(void 0!==w){for(var N=p.props.attrs,C=A.observer,k=A.data,T=0;T<w.length;T++){var R=w[T];k[R]=N[R],C.notify(R)}O=!0}var q=p.data.events;void 0!==q&&y(q,b.events);var Z=p.children;0!==Z.length&&(A.insert=Z,O=!0),!0===O&&(A.build(),i(A,"updated"))}else if("#text"===g){var _=p.value;b.node.textContent=_,m.value=_}else x(p,m)}}}}(e.children,t.children,r)},A=function(e,t){var n=e.methods,r=function(r){n[r]=function(){return t[r].apply(e,arguments)}};for(var o in t)r(o)},O=function(e,t){var n=e.data,r=e.observer,o=function(o){var i=t[o],a=i.get,v=i.set;Object.defineProperty(n,o,{get:function(){var t;return void 0===r.cache[o]?(r.target=o,t=a.call(e),r.target=void 0,r.cache[o]=t):t=r.cache[o],t},set:void 0===v?s:function(t){v.call(e,t)}})};for(var i in t)o(i)};function w(){this.target=void 0,this.cache={},this.map={}}w.prototype.notify=function(e){var t=this.map[e];if(void 0!==t)for(var n=0;n<t.length;n++)this.notify(t[n]);var r=this.cache;void 0!==r[e]&&(r[e]=void 0)};var N=/^<\s*(\/?)\s*/i,C=/^([_A-Z][_A-Z\d\-\.]*)\s*/i,k=/^([_A-Z][_A-Z\d\-\.:]*)\s*(=?)\s*/i,T=/^(["']?)(.*?)\1\s*/i,R=/^(\/?)\s*>/i,q=/\{\{\s*/,Z=/\s*\}\}/,_=/[\s]/g,j=/<\/?(?:[A-Z]+\w*)|<!--/i,E=/"[^"]*"|'[^']*'|\d+[a-zA-Z$_]\w*|\.[a-zA-Z$_]\w*|[a-zA-Z$_]\w*:|([a-zA-Z$_]\w*)(?:\s*\()?/g,L=/(?:(?:&(?:amp|gt|lt|nbsp|quot);)|"|\\|\n)/g,M={"&amp;":"&","&gt;":">","&lt;":"<","&nbsp;":" ","&quot;":'\\"',"\\":"\\\\",'"':'\\"',"\n":"\\n"},S=["NaN","false","in","instance","m","null","staticNodes","true","typeof","undefined"],z=["area","base","br","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],$=["animate","circle","clippath","cursor","defs","desc","ellipse","filter","font-face","foreignObject","g","glyph","image","line","marker","mask","missing-glyph","path","pattern","polygon","polyline","rect","svg","switch","symbol","text","textpath","tspan","use","view"],I=2,V=function(e,t){for(var n,r=t.dependencies,o=r.props,i=r.methods,a=t.exclude,s=t.locals,v=!1;null!==(n=E.exec(e));){var d=n[0],u=n[1];void 0!==u&&-1===a.indexOf(u)&&("("===d[d.length-1]?-1===i.indexOf(u)&&i.push(u):(-1===s.indexOf(u)&&-1===o.indexOf(u)&&o.push(u),v=!0))}return v},D=function(e,t){var n=e.length,r=0,o=!1,i="";if(0===n)i='""';else for(;r<n;){var a=e.substring(r),s=a.match(q);if(null===s){i+='"'+a+'"';break}var v=s.index;0!==v&&(i+='"'+a.substring(0,v)+'"',r+=v),o=!0,0!==r&&(i+=" + "),r+=s[0].length;var d=e.substring(r),u=d.match(Z),f=u.index,l=d.substring(0,f);V(l,t),i+="("+l+")",(r+=l.length+u[0].length)!==n&&(i+=" + ")}return{output:i,dynamic:o}},H=function(e){for(var t=[],n="";;){var r=e.match(k);if(null===r)break;e=e.substr(r[0].length),n+=r[0];var o="";"="===r[2]&&(o=e.match(T),e=e.substr(o[0].length),n+=o[0],o=o[2]),r=r[1].split(":"),t.push({name:r[0],value:o,argument:r[1],data:{}})}return{match:n,attributes:t}},F=function(e,t){var n=t.length;return t[n]=e,"staticNodes["+n+"]"},P=function(e){var t="{",n="",r=e.events,o="";if(void 0!==r){for(var i in t+="events: {",r){t+=n+'"'+i+'": [';for(var a=r[i],s=0;s<a.length;s++)t+=o+a[s],o=", ";n=", ",o="",t+="]"}t+="}",delete e.events}for(var v in 0===e.flags&&delete e.flags,e)t+=""+n+v+": "+e[v],n=", ";return t+"}"},B=function(e,t){for(var n=e+": {",r="",o=0;o<t.length;o++){var i=t[o],a=i.value;0===a.length&&(a='""'),n+=r+'"'+i.name+'": '+a,r=", "}return n+"}"},G=function(e,n,r){var o=e.type;if("#text"===o){var i=D(e.value,r);return e.value=i.output,i.dynamic}if("m-insert"===o)return n.deep=!0,!0;var a=r.locals,s=!1,v=e.data;-1!==$.indexOf(o)&&(v.flags=v.flags|I);var d=e.props,u=d.length,f=[],l=[],c=[];e.props={attrs:f,dom:[],directives:l,specialDirectivesAfter:c};for(var p=0;p<u;p++){var h=d[p],m=t[h.name];if(void 0!==m){var g=m.after;void 0!==g&&c.push({prop:h,after:g});var y=m.before;void 0!==y&&!0===y(h,e,n,r)&&(s=!0)}}for(var b=0;b<u;b++){var x=d[b],A=x.name,O=t[A];if(void 0!==O){var w=O.during;void 0!==w&&(!0===w(x,e,n,r)&&(s=!0),f.push(x))}else if("m"===A[0]&&"-"===A[1])!0===V(x.value,r)&&(s=!0),l.push(x);else{var N=D(x.value,r);!0===N.dynamic&&(s=!0),x.value=N.output,f.push(x)}}for(var C=e.children,k=[],T=0;T<C.length;T++){var R=G(C[T],e,r);!0===R&&(s=!0),k.push(R)}for(var q=0;q<C.length;q++)if(!0===s&&!1===k[q]){var Z=C[q].data;Z.flags=1|Z.flags}return r.locals=a,s},J=function(e,t,n){var r,o=e.type,i=e.data;if("#text"===o)r='m("#text", '+P(i)+", "+e.value+")";else if("m-insert"===o)r="instance.insert";else{r='m("'+o+'", {';var a=e.props,s="",v=a.attrs;0!==v.length&&(r+=B("attrs",v),s=", ");var d=a.directives;0!==d.length&&(r+=B(s+"directives",d),s=", ");var u=a.dom;0!==u.length&&(r+=B(s+"dom",u)),r+="}, "+P(i)+", ";for(var f="",l="",c=e.children,p=0;p<c.length;p++)f+=l+J(c[p],e,n),l=", ";!0===e.deep?r+="m.flatten(["+f+"]))":r+="["+f+"])";for(var h=a.specialDirectivesAfter,m=0;m<h.length;m++){var g=h[m];r=g.after(g.prop,r,e,t,n)}}return 1==(1&i.flags)?F(r,n.staticNodes):r},K=function(e){return function(e){var t={staticNodes:[],dependencies:{props:[],methods:[]},exclude:S,locals:[]};if(!1===G(e,void 0,t)){var n=e.data;n.flags=1|n.flags}for(var r=J(e,void 0,t),i=t.dependencies,a=i.props,v=i.methods,d="",u=t.staticNodes,f="",l=0,c="";l<a.length;l++){var p=a[l];d+="var "+p+' = instance.get("'+p+'");'}for(l=0;l<v.length;l++){var h=v[l];d+="var "+h+' = instance.methods["'+h+'"];'}for(l=0;l<u.length;l++)f+=c+u[l],c=", ";try{return new Function("m","var instance = this;var staticNodes = instance.compiledRender.staticNodes;"+d+"if(staticNodes === undefined) {staticNodes = instance.compiledRender.staticNodes = ["+f+"];}return "+r+";")}catch(e){return o("Could not create render function"),s}}(function(e){for(var t={type:"ROOT",props:{},children:[]},n=[t],r=0,o=0;o<e.length;o++){var i=e[o];if("Text"===i.type)n[r].children.push({type:"#text",data:{flags:0},value:i.value});else if("Tag"===i.type)if(!0===i.closeStart)n.pop(),r--;else{var a=i.value,s=n[r].children,v=s.length,d={type:a,index:v,props:i.attributes,data:{flags:0},children:[]};s[v]=d,!1===i.closeEnd&&-1===z.indexOf(a)&&(n.push(d),r++)}}return t.children[0]}(function(e){for(var t,n,r,o,i=[];e.length>0;)if("<"===e[0])if("\x3c!--"!==e.substr(0,4)){var a,s,v,d,u=e.match(N);v="/"===u[1];var f=(e=e.substr(u[0].length)).match(C);a=f[1],e=e.substr(f[0].length);var l=H(e);s=l.attributes;var c=(e=e.substr(l.match.length)).match(R);d="/"===c[1],e=e.substr(c[0].length),i.push({type:"Tag",value:a,attributes:s,closeStart:v,closeEnd:d})}else{var p=-1===(n=(t=e).indexOf("--\x3e",4))?t:t.substring(0,n+3);e=e.substr(p.length)}else{var h=-1===(o=(r=e).search(j))?r:r.substring(0,o);e=e.substr(h.length),h.replace(/\s/g,"").length>0&&i.push({type:"Text",value:h.replace(L,function(e){return M[e]})})}return i}(e)))};function Q(e){void 0===e&&(e={}),this.options=e,a(this,"name",e.name,"Root"),this.root=void 0;var t=e.data;this.data=void 0===t?{}:"function"==typeof t?t():t;var n=e.methods;this.methods={},void 0!==n&&A(this,n),a(this,"compiledRender",e.render,s),a(this,"hooks",e.hooks,{}),this.events={},this.dom={},this.observer=new w,this.queued=!0;var r=e.computed;void 0!==r&&O(this,r),this.init()}Q.prototype.get=function(e){var t=this.observer,n=t.map,r=t.target;return void 0!==r&&(void 0===n[e]?n[e]=[r]:-1===n[e].indexOf(r)&&n[e].push(r)),this.data[e]},Q.prototype.set=function(e,t){var n,r=this.observer;if("object"==typeof e){var o=this.data;for(var a in e)o[a]=e[a],r.notify(a)}else this.data[e]=t,r.notify(e);!1===(n=this).queued&&(n.queued=!0,setTimeout(function(){n.build(),n.queued=!1,i(n,"updated")},0))},Q.prototype.destroy=function(){this.off(),this.root=void 0,this.queued=!0,i(this,"destroyed")},Q.prototype.on=function(e,t){var n=this.events,r=n[e];void 0===r?n[e]=[t]:r.push(t)},Q.prototype.off=function(e,t){if(void 0===e)this.events={};else if(void 0===t)this.events[e]=[];else{var n=this.events[e],r=n.indexOf(t);n.splice(r,1)}},Q.prototype.emit=function(e,t){var n,r=this.events,o=r[e],i=r["*"];if(void 0!==o)for(n=0;n<o.length;n++)o[n](t);if(void 0!==i)for(n=0;n<i.length;n++)i[n](e,t)},Q.prototype.mount=function(e){var t=this.root="string"==typeof e?document.querySelector(e):e;a(this,"template",this.options.template,t.outerHTML),this.compiledRender===s&&(this.compiledRender=Q.compile(this.template)),this.queued=!1;var n=this.render();if(t.nodeName.toLowerCase()===n.type)b(t,n);else{var r=d(n);p(r,t,t.parentNode),this.root=r}this.dom=n,i(this,"mounted")},Q.prototype.render=function(){return this.compiledRender(m)},Q.prototype.build=function(){var e=this.render(),t=this.dom;e!==t&&x(e,t)},Q.prototype.init=function(){r("======= Moon ======="),i(this,"init");var e=this.options.root;void 0!==e&&this.mount(e)},Q.config={silent:!0},Q.version="0.11.0",Q.util={noop:s,log:r,error:o,m:m},Q.use=function(e,t){e.init(Q,t)},Q.compile=function(e){return K(e)},Q.nextTick=function(e){setTimeout(e,0)},Q.directive=function(t,n){e["m-"+t]=n},Q.extend=function(e,t){function r(e){this.componentOptions=e,Q.apply(this,[t])}return t.name=e,void 0!==t.data&&"function"!=typeof t.data&&o("In components, data must be a function returning an object"),r.prototype=Object.create(Q.prototype),r.prototype.constructor=r,r.prototype.init=function(){var e=this.componentOptions,t=e.props,n=this.data;for(var r in t)n[r]=t[r];this.events=e.events,this.insert=e.insert,i(this,"init");var o=e.root;void 0!==o&&this.mount(o)},n[e]={CTor:r,options:t},r};var U=/\.|\[/,W=function(e,t,n){var r=n.data,o=r.events;if(void 0===o)(o=r.events={})[e]=[t];else{var i=o[e];void 0===i?o[e]=[t]:i.push(t)}},X=function(e,t,n){n.props.dom.push({name:e,value:t})};return t["m-if"]={before:function(e,t,n,r){var o=n.children,i=t.index+1,a=o[i];if(V(e.value,r),void 0!==a)for(var s=a.props,v=0;v<s.length;v++){if("m-else"===s[v].name){if(s.splice(v,1),!1===G(a,n,r))for(var d=a.children,u=0;u<d.length;u++){var f=d[u].data;f.flags=1|f.flags}e.data.elseOutput=J(a,n,r),o.splice(i,1);break}}return!0},after:function(e,t,n,r,o){var i=e.data.elseOutput;return void 0===i&&(i=F("m(\"#text\", {flags: 1}, '')",o.staticNodes)),e.value+" ? "+t+" : "+i}},t["m-for"]={before:function(e,t,n,r){n.deep=!0;var o=e.value.split(" in "),i=o[0].replace(_,""),a=o[1],s=e.data;return s.forIteratable=a,s.forAliases=i,r.locals=r.locals.concat(i.split(",")),V(a,r),!0},after:function(e,t,n,r,o){var i=e.data;return"m.renderLoop("+i.forIteratable+", function("+i.forAliases+") {return "+t+";})"}},t["m-on"]={before:function(e,t,n,r){var o=r.exclude,i=e.value;-1===i.indexOf("(")&&(i+="()"),W(e.argument,"function(event) {"+i+";}",t),o.push("event");var a=V(i,r);return o.pop(),a}},t["m-bind"]={before:function(e,t,n,r){var o,i,a=e.value,s=a.search(U);-1!==s&&(a='instance.get("'+(o=a.substring(0,s))+'")'+(i=a.substring(s)));var v="event.target.value",d=a;return W("input",-1===s?'function(event) {instance.set("'+a+'", '+v+");}":'function(event) {var boundValue = instance.get("'+o+'");boundValue'+i+" = "+v+';instance.set("'+o+'", boundValue);}',t),X("value",d,t),V(a,r)}},t["m-dom"]={before:function(e,t,n,r){var o=e.value;return X(e.argument,o,t),V(o,r)}},t["m-literal"]={during:function(e,t,n,r){var o=e.argument;return e.name=o,"class"===o&&(e.value="m.renderClass("+e.value+")"),V(e.value,r)}},t["m-mask"]={},Q});